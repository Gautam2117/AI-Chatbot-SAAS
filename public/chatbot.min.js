(function(){const s=document.currentScript,a=s.getAttribute("data-user-id")||"guest-user",b=s.getAttribute("data-color")||"#4f46e5",c=s.getAttribute("data-font")||"Arial,sans-serif",d=s.getAttribute("data-border-radius")||"16px",e=s.getAttribute("data-position")||"bottom-right",f=s.getAttribute("data-icon")||"üí¨",g=s.getAttribute("data-theme")||"light",h="https://ai-chatbot-backend-h669.onrender.com",i="bottom-left"===e?"bottom:24px;left:24px;":"bottom:24px;right:24px;";let j=g,k=document.createElement("style");k.textContent=`.botify-widget-button{position:fixed;${i}background-color:${b};color:white;border:none;border-radius:50%;width:70px;height:70px;font-size:34px;cursor:pointer;box-shadow:0 4px 20px rgba(0,0,0,0.4);transition:transform 0.3s ease;z-index:9999;}.botify-widget-button:hover{transform:scale(1.1);}.botify-widget-container{position:fixed;${i}width:400px;max-height:600px;background:rgba(255,255,255,0.95);backdrop-filter:blur(12px);border-radius:${d};font-family:${c};box-shadow:0 12px 30px rgba(0,0,0,0.3);display:flex;flex-direction:column;overflow:hidden;z-index:9999;animation:fadeInUp 0.4s ease;}.botify-widget-container.dark{background:rgba(34,34,34,0.95);color:white;}.botify-widget-header{background-color:${b};color:white;padding:12px;font-weight:bold;text-align:center;display:flex;justify-content:space-between;align-items:center;}.botify-widget-header button{background:transparent;border:none;color:white;cursor:pointer;font-size:18px;}.botify-widget-messages{flex:1;padding:10px;overflow-y:auto;font-size:14px;}.botify-widget-input{display:flex;border-top:1px solid #ddd;}.botify-widget-input input{flex:1;border:none;padding:12px;font-size:14px;outline:none;}.botify-widget-input button{background-color:${b};color:white;border:none;padding:12px 18px;cursor:pointer;}@keyframes fadeInUp{from{transform:translateY(30px);opacity:0;}to{transform:translateY(0);opacity:1;}}.botify-loader{border:3px solid #f3f3f3;border-top:3px solid ${b};border-radius:50%;width:16px;height:16px;animation:spin 1s linear infinite;display:inline-block;vertical-align:middle;}@keyframes spin{100%{transform:rotate(360deg);}}`,document.head.appendChild(k);const l=document.createElement("button");l.className="botify-widget-button",l.innerHTML=f,document.body.appendChild(l);const m=document.createElement("div");m.className=`botify-widget-container ${j}`,m.style.display="none",m.innerHTML=`<div class="botify-widget-header"><span>Botify Assistant</span><button id="theme-toggle">${"light"===j?"üåô":"‚òÄÔ∏è"}</button></div><div class="botify-widget-messages" id="botify-messages"></div><div class="botify-widget-input"><input type="text" placeholder="Type your message..." id="botify-input" /><button id="botify-send">Send</button></div>`,document.body.appendChild(m),l.addEventListener("click",()=>{m.style.display="none"===m.style.display?"flex":"none"});const n=m.querySelector("#botify-send"),o=m.querySelector("#botify-input"),p=m.querySelector("#botify-messages"),q=m.querySelector("#theme-toggle"),r=(d,c,e=!1)=>{const a=document.createElement("div");a.style.margin="8px 0",a.innerHTML=e?`<strong>${d}:</strong> <span class="botify-loader"></span>`:`<strong>${d}:</strong> ${c}`,p.appendChild(a),p.scrollTop=p.scrollHeight};n.addEventListener("click",async()=>{const c=o.value.trim();if(!c)return;r("You",c),o.value="",r("Bot","",!0);try{const b=await fetch(`${h}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json","x-user-id":a},body:JSON.stringify({question:c,faqs:[]})}),d=await b.json();p.lastChild.innerHTML=`<strong>Bot:</strong> ${d.reply||"No response"}`}catch(a){p.lastChild.innerHTML="Bot: Error connecting to server.",console.error(a)}}),o.addEventListener("keypress",a=>{"Enter"===a.key&&n.click()}),q.addEventListener("click",()=>{j="light"===j?"dark":"light",m.classList.toggle("dark","dark"===j),q.textContent="light"===j?"üåô":"‚òÄÔ∏è"})})();
