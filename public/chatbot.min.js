!function(){const e=document.currentScript,t=e.getAttribute("data-user-id")||"guest-user",o=e.getAttribute("data-brand")||"Botify",i=e.getAttribute("data-color")||"#7C3AED",n=e.getAttribute("data-font")||"Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif",a=e.getAttribute("data-border-radius")||"22px",r=(e.getAttribute("data-position")||"bottom-right").toLowerCase(),s="false"!==(e.getAttribute("data-draggable")||"true"),d=e.getAttribute("data-logo")||"https://ai-chatbot-saas-eight.vercel.app/chatbot_widget_logo.png",l="false"!==e.getAttribute("data-poweredby"),b="https://ai-chatbot-backend-h669.onrender.com";let c=localStorage.getItem("botify:lang")||"en";const p={en:{welcome:"Hello! How can I assist you today?",send:"Send",typing:`${o} is typing…`,mic:"🎤",placeholder:"Type a message…",online:"Online",offline:"Unavailable",help:"💡 Need help with something? Just ask!"},hi:{welcome:"नमस्ते! मैं आपकी कैसे मदद कर सकता हूँ?",send:"भेजें",typing:`${o} लिख रहा है…`,mic:"🎤",placeholder:"संदेश लिखें…",online:"ऑनलाइन",offline:"उपलब्ध नहीं",help:"💡 किसी मदद की ज़रूरत है? पूछिए!"},es:{welcome:"¡Hola! ¿En qué puedo ayudarte hoy?",send:"Enviar",typing:`${o} está escribiendo…`,mic:"🎤",placeholder:"Escribe un mensaje…",online:"En línea",offline:"No disponible",help:"💡 ¿Necesitas ayuda? ¡Pregunta!"},fr:{welcome:"Bonjour ! Comment puis-je vous aider ?",send:"Envoyer",typing:`${o} est en train d’écrire…`,mic:"🎤",placeholder:"Écrivez un message…",online:"En ligne",offline:"Indisponible",help:"💡 Besoin d’aide ? Demandez !"},zh:{welcome:"你好！我能为您做些什么？",send:"发送",typing:`${o} 正在输入…`,mic:"🎤",placeholder:"输入消息…",online:"在线",offline:"不可用",help:"💡 需要帮助吗？尽管问！"},ar:{welcome:"مرحبًا! كيف يمكنني مساعدتك؟",send:"إرسال",typing:`${o} يكتب…`,mic:"🎤",placeholder:"اكتب رسالة…",online:"متصل",offline:"غير متاح",help:"💡 هل تحتاج مساعدة؟ اسأل!"}},f=e=>p[c]&&p[c][e]||p.en[e]||e,y=r.includes("left"),u=`bottom:20px; ${y?"left":"right"}:20px;`,g=document.createElement("style");g.textContent=`\n  :root{--botify-primary:${i};--botify-font:${n};--botify-radius:${a};}\n  .botify__launcher{position:fixed;${u}width:64px;height:64px;border:0;background:transparent;cursor:pointer;z-index:9999}\n  .botify__badge{position:absolute;top:-4px;${y?"left":"right"}:-4px;min-width:20px;height:20px;padding:0 6px;font:700 11px/20px var(--botify-font);color:#fff;text-align:center;background:#EF4444;border-radius:999px;box-shadow:0 4px 12px rgba(0,0,0,.25);display:none}\n  .botify__launcher-img{width:100%;height:100%;border-radius:50%;box-shadow:0 12px 28px rgba(0,0,0,.25);transition:transform .25s ease, box-shadow .25s ease}\n  .botify__launcher:hover .botify__launcher-img{transform:scale(1.06);box-shadow:0 16px 36px rgba(0,0,0,.32)}\n  .botify__pulse::after{content:"";position:absolute;inset:0;border-radius:999px;z-index:-1;box-shadow:0 0 0 0 var(--botify-primary);animation:botifyPulse 2s infinite}\n  @keyframes botifyPulse{0%{box-shadow:0 0 0 0 rgba(124,58,237,.35)}70%{box-shadow:0 0 0 22px rgba(124,58,237,0)}100%{box-shadow:0 0 0 0 rgba(124,58,237,0)}}\n  .botify__wrap{position:fixed;${u}z-index:9999;display:none;width:360px;max-height:640px;overflow:hidden;border-radius:var(--botify-radius);background:rgba(255,255,255,.92);backdrop-filter:blur(14px);box-shadow:0 30px 60px rgba(0,0,0,.25);font-family:var(--botify-font);color:#0f172a;transform:translateY(30px);opacity:0;animation:botifyIn .35s ease forwards}\n  @keyframes botifyIn{to{transform:translateY(0);opacity:1}}\n  @media (max-width:480px){.botify__wrap{width:calc(100vw - 18px);height:calc(100vh - 18px);max-height:none;${y?"left:9px":"right:9px"};bottom:9px;border-radius:18px}}\n  .botify__header{display:flex;align-items:center;gap:10px;padding:12px;color:#fff;background:linear-gradient(135deg,var(--botify-primary),#EC4899);position:relative;cursor:grab;user-select:none}\n  .botify__brand{display:flex;align-items:center;gap:10px;min-width:0;flex:1}\n  .botify__logo{width:38px;height:38px;border-radius:50%;object-fit:cover}\n  .botify__title{font-weight:800;letter-spacing:.2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}\n  .botify__status{font-size:11px;opacity:.85;display:flex;align-items:center;gap:6px}\n  .botify__dot{width:8px;height:8px;border-radius:50%;background:#22c55e;box-shadow:0 0 0 4px rgba(34,197,94,.2)}\n  .botify__ctrls{display:flex;align-items:center;gap:8px}\n  .botify__select,.botify__btn{appearance:none;border:0;border-radius:10px;padding:6px 10px;background:rgba(255,255,255,.22);color:#fff;font-size:12px;cursor:pointer;transition:background .2s ease}\n  .botify__btn:hover,.botify__select:hover{background:rgba(255,255,255,.34)}\n  .botify__messages{background:linear-gradient(180deg,#F8FAFC,#EEF2FF);padding:12px;display:flex;flex-direction:column;gap:10px;overflow-y:auto;height:360px}\n  .botify__row{display:flex;gap:8px}\n  .botify__bubble{max-width:78%;padding:10px 14px;border-radius:18px;line-height:1.42;box-shadow:0 2px 10px rgba(2,6,23,.08)}\n  .botify__bubble--bot{background:#fff;border-top-left-radius:6px}\n  .botify__bubble--me{margin-left:auto;background:#E0EAFF;border-top-right-radius:6px}\n  .botify__chips{display:flex;flex-wrap:wrap;gap:8px;padding:0 12px 8px}\n  .botify__chip{background:#fff;border:1px solid rgba(99,102,241,.2);color:#4f46e5;padding:6px 10px;border-radius:999px;font-size:12px;cursor:pointer;transition:transform .12s ease,box-shadow .12s ease}\n  .botify__chip:hover{transform:translateY(-1px);box-shadow:0 6px 14px rgba(79,70,229,.2)}\n  .botify__input{display:flex;align-items:center;gap:6px;padding:8px;border-top:1px solid rgba(99,102,241,.18);background:rgba(255,255,255,.7)}\n  .botify__field{flex:1;border:0;background:transparent;padding:12px;outline:none;font-size:14px}\n  .botify__send,.botify__mic{border:0;cursor:pointer;border-radius:999px;width:38px;height:38px;display:grid;place-items:center;transition:transform .1s ease,box-shadow .2s ease,background .2s ease}\n  .botify__send{background:var(--botify-primary);color:#fff;box-shadow:0 8px 20px rgba(79,70,229,.35)}\n  .botify__mic{background:#EEF2FF;color:var(--botify-primary)}\n  .botify__send:hover{transform:translateY(-1px)}\n  .botify__mic:hover{background:#E0EAFF}\n  .botify__footer{font-size:10px;color:#64748b;text-align:center;padding:6px 0 10px}\n  .botify__footer a{color:var(--botify-primary);font-weight:700;text-decoration:none}\n  .botify__typing{display:flex;align-items:center;gap:8px;color:#334155}\n  .botify__dots{display:flex;gap:4px}\n  .botify__dotpulse{width:8px;height:8px;background:var(--botify-primary);border-radius:50%;animation:dot 1.2s infinite ease-in-out;opacity:.7}\n  .botify__dotpulse:nth-child(2){animation-delay:.15s}.botify__dotpulse:nth-child(3){animation-delay:.3s}\n  @keyframes dot{0%,80%,100%{transform:scale(.75);opacity:.35}40%{transform:scale(1.15);opacity:1}}\n  .botify--dark .botify__wrap{background:rgba(17,24,39,.9);color:#e5e7eb}\n  .botify--dark .botify__messages{background:linear-gradient(180deg,#0f172a,#111827)}\n  .botify--dark .botify__bubble--bot{background:#0B1020;color:#e5e7eb}\n  .botify--dark .botify__bubble--me{background:#1E293B;color:#e5e7eb}\n  .botify--dark .botify__input{background:rgba(17,24,39,.8);border-top-color:rgba(99,102,241,.2)}\n  .botify--dark .botify__mic{background:#0B1020;color:#c7d2fe}\n  `,document.head.appendChild(g);const h=document.createElement("button");h.className="botify__launcher botify__pulse",h.setAttribute("aria-label","Open chat"),h.innerHTML=`<span class="botify__badge" id="botifyBadge">1</span><img class="botify__launcher-img" src="${d}" alt="${o} Chat" />`,document.body.appendChild(h);const m=document.createElement("div");m.className="botify__wrap",m.setAttribute("role","dialog"),m.setAttribute("aria-label",`${o} Chat`),m.setAttribute("aria-live","polite"),m.style.display="none",m.innerHTML=`\n    <div class="botify__header" id="botifyHeader">\n      <div class="botify__brand" title="${o}">\n        <img class="botify__logo" src="${d}" alt="${o}"/>\n        <div style="min-width:0">\n          <div class="botify__title">${o} Chat</div>\n          <div class="botify__status"><span class="botify__dot" id="botifyStatusDot"></span><span id="botifyStatusText">Online</span></div>\n        </div>\n      </div>\n      <div class="botify__ctrls">\n        <select class="botify__select" id="botifyLang">${Object.keys(p).map(e=>`<option value="${e}" ${e===c?"selected":""}>${e.toUpperCase()}</option>`).join("")}</select>\n        <button class="botify__btn" id="botifyTheme" title="Toggle theme">🌙</button>\n        <button class="botify__btn" id="botifyClose" title="Close">✕</button>\n      </div>\n    </div>\n    <div class="botify__messages" id="botifyMsgs"></div>\n    <div class="botify__chips" id="botifyChips"></div>\n    <div class="botify__input">\n      <input class="botify__field" id="botifyField" type="text" placeholder="${f("placeholder")}" />\n      <button class="botify__mic" id="botifyMic" title="Voice">🎤</button>\n      <button class="botify__send" id="botifySend" title="${f("send")}">➤</button>\n    </div>\n    ${l?'<div class="botify__footer">Powered by <a target="_blank" href="https://botify-website.vercel.app/">Botify</a></div>':""}\n  `,document.body.appendChild(m);const _=e=>m.querySelector(`#${e}`),x=_("botifyMsgs"),v=_("botifyField"),w=_("botifySend"),k=_("botifyMic"),E=_("botifyClose"),C=_("botifyTheme"),$=_("botifyLang"),S=document.getElementById("botifyHeader"),L=document.getElementById("botifyBadge"),T=_("botifyStatusDot"),A=_("botifyStatusText"),F=_("botifyChips"),H=(e,t)=>localStorage.setItem(`botify:${e}`,String(t)),I=(e,t)=>localStorage.getItem(`botify:${e}`)??t;function M(e){T.style.background=e?"#22c55e":"#ef4444",A.textContent=f(e?"online":"offline")}function N(e){L&&(e>0?(L.style.display="inline-block",L.textContent=String(e)):L.style.display="none")}let B=Number(I("unread","1"));function z(){m.style.display="none"}function Y(e,t=!1,o=!1){const i=document.createElement("div");i.className="botify__row";const n=document.createElement("div");return n.className="botify__bubble "+(t?"botify__bubble--me":"botify__bubble--bot"),o?n.innerHTML=e:n.textContent=e,i.appendChild(n),x.appendChild(i),x.scrollTop=x.scrollHeight,t||"none"!==m.style.display||(B+=1,N(B),H("unread",String(B))),n}N(B),["What can you do?","How do I integrate the widget?","Show pricing plans","Contact support"].forEach(e=>{const t=document.createElement("button");t.className="botify__chip",t.textContent=e,t.addEventListener("click",()=>{v.value=e,w.click()}),F.appendChild(t)}),h.addEventListener("click",()=>"none"===m.style.display?(m.style.display="block",setTimeout(()=>v.focus(),50),N(0),void H("unread","0")):z()),E.addEventListener("click",z),v.addEventListener("keydown",e=>{"Enter"===e.key&&(e.preventDefault(),w.click())}),$.addEventListener("change",e=>{c=e.target.value,v.placeholder=f("placeholder"),H("lang",c)});const j=I("theme","light");if("dark"===j&&document.body.classList.add("botify--dark"),C.textContent="dark"===j?"☀️":"🌙",C.addEventListener("click",()=>{const e=document.body.classList.toggle("botify--dark");C.textContent=e?"☀️":"🌙",H("theme",e?"dark":"light")}),"webkitSpeechRecognition"in window||"SpeechRecognition"in window){const e=new(window.SpeechRecognition||window.webkitSpeechRecognition);e.lang="en-US",e.interimResults=!1,e.maxAlternatives=1,k.addEventListener("click",()=>e.start()),e.onresult=e=>{v.value+=e.results[0][0].transcript+" ",v.focus()}}else k.style.display="none";if(s&&window.matchMedia("(pointer:fine)").matches){let e=!1,t=0,o=0,i=0,n=0;const a=a=>{e=!0,S.style.cursor="grabbing";const d=m.getBoundingClientRect();i=d.left,n=d.top,t=a.clientX,o=a.clientY,document.addEventListener("mousemove",r),document.addEventListener("mouseup",s)},r=a=>{if(!e)return;const r=a.clientX-t,s=a.clientY-o;m.style.left=i+r+"px",m.style.top=n+s+"px",m.style.right="auto",m.style.bottom="auto"},s=()=>{e=!1,S.style.cursor="grab",document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",s)};S.addEventListener("mousedown",a)}async function R(e){Y(e,!0),v.value="";const o=function(){const e=document.createElement("div");e.className="botify__row";const t=document.createElement("div");return t.className="botify__bubble botify__bubble--bot",t.innerHTML=`<div class="botify__typing"><div class="botify__dots"><span class="botify__dotpulse"></span><span class="botify__dotpulse"></span><span class="botify__dotpulse"></span></div><span>${f("typing")}</span></div>`,e.appendChild(t),x.appendChild(e),x.scrollTop=x.scrollHeight,e}();try{const i=await fetch(`${b}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json","x-user-id":t},body:JSON.stringify({question:e,lang:c,faqs:[]})});if(403===i.status)return o.remove(),M(!1),Y("<strong>🙏 We're currently unavailable</strong><br/>The team reached its daily usage limit. Please try again later.",!1,!0),void O(!0);if(M(!0),!i.body)return o.remove(),void Y("⚠️ Streaming not supported by this browser.");const n=i.body.getReader(),a=new TextDecoder("utf-8");o.remove();const r=Y("",!1);let s="";for(;;){const{value:e,done:t}=await n.read();if(t)break;s+=a.decode(e,{stream:!0}),r.textContent=s,x.scrollTop=x.scrollHeight}s||(r.textContent="⚠️ No response")}catch(e){o.remove(),M(!1),Y("❌ Unable to connect. Please try again later.")}}function O(e=!0){v.disabled=e,w.disabled=e,k.disabled=e,m.style.opacity=e?".65":"1",v.placeholder=e?"Support is currently unavailable.":f("placeholder")}!function(){let e=null,t=!1;S.addEventListener("touchstart",o=>{e=o.touches[0].clientY,t=!1},{passive:!0}),S.addEventListener("touchmove",o=>{if(null==e)return;const i=o.touches[0].clientY-e;i>10&&(t=!0,m.style.transform=`translateY(${Math.min(i,140)}px)`,m.style.opacity=String(Math.max(.3,1-i/300)))},{passive:!0}),S.addEventListener("touchend",()=>{if(!t)return void(e=null);const o=new WebKitCSSMatrix(getComputedStyle(m).transform);Math.abs(o.m42||0)>120&&z(),m.style.transform="translateY(0px)",m.style.opacity="1",e=null},{passive:!0})}(),w.addEventListener("click",()=>{const e=v.value.trim();e&&R(e)}),Y(f("welcome")),setTimeout(()=>Y(f("help")),12e3),async function(){try{const e=await fetch(`${b}/api/usage-status`,{headers:{"x-user-id":t}});(await e.json()).blocked?(M(!1),Y("🚫 <strong>Chat temporarily unavailable</strong><br/>Our support team reached its daily limit.",!1,!0),O(!0)):(M(!0),O(!1))}catch(e){}}(),setInterval(async()=>{try{const e=await fetch(`${b}/api/usage-status`,{headers:{"x-user-id":t}});(await e.json()).blocked||(M(!0),O(!1))}catch(e){}},3e5)}();